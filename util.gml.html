<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>util.gml - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Map.html">Map</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.exists">exists</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.is_empty">is_empty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Map.html#.set">set</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_add">_add</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_div">_div</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_floordiv">_floordiv</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_identity">_identity</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_list">_list</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_map">_map</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_max">_max</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_min">_min</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_mod">_mod</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_mul">_mul</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_pow">_pow</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_priority">_priority</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_queue">_queue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_rem">_rem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_stack">_stack</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_sub">_sub</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#_truth">_truth</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#apply">apply</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#assert">assert</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#assert_array_equals">assert_array_equals</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#assert_equals">assert_equals</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#bit_length">bit_length</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#factorial">factorial</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#is_between">is_between</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#isqrt">isqrt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#log">log</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#NV_MAGICCONST">NV_MAGICCONST</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#SMALL_FACTORIALS">SMALL_FACTORIALS</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#to_string">to_string</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#TWOPI">TWOPI</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">util.gml</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#region const

/// @constant {Number} TWOPI
/// @desc Also known as global.tau
/// @default 2*pi

global.tau = 2 * pi;
#macro TWOPI global.tau

/// @constant {Number} NV_MAGICCONST
/// @desc Also known as global.nv_magicconst. Used in normal variate random distribution.
/// @default 4 * exp( -0.5 ) / sqrt( 2.0 )

global.nv_magicconst = 4 * exp( -0.5 ) / sqrt( 2.0 )
#macro NV_MAGICCONST global.nv_magicconst

/// @constant {Number} SMALL_FACTORIALS
/// @desc Also known as global.small_factorials. Lookup table for int64 factorial values.
/// @default [0!..20!]

global.small_factorials = [ 1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 
		3628800, 39916800, 479001600, 6227020800, 87178291200, 1307674368000, 
		20922789888000, 355687428096000, 6402373705728000, 121645100408832000, 2432902008176640000 ];
#macro SMALL_FACTORIALS global.small_factorials

#endregion

#region test

/// @func assert
///
/// @desc Asserts that a condition is true. If it isn't it throws an error with the given message.
///
/// @arg {Bool} condidion
/// @arg {String} message

function assert( _condition, _message ) {
	if ( !_condition ) {
		show_error( _message, true );		
	}
}

/// @func assert_equals
///
/// @desc Asserts that two arguments are equal. If they are not, an error is thrown with the given message. 
///
/// @arg {Any} expected
/// @arg {Any} actuals
/// @arg {String} [message]

function assert_equals( _expected, _actual, _message ) {
	_message = is_undefined( _message ) ? "" : _message;
	if ( typeof( _expected ) == "array" ) {
		assert( array_equals( _expected, _actual ), _message );	
	} else {
		assert( _expected == _actual, _message );
	}
}

/// @func assert_array_equals
///
/// @desc Asserts that two arguments are equal. If they are not, an error is thrown with the given message. 
///
/// @arg {Array} expected
/// @arg {Array} actuals
/// @arg {String} [message]

function assert_array_equals( _expected, _actual, _message ) {
	_message = is_undefined( _message ) ? "" : _message;
	var _size = array_length( _expected );
	assert( _size == array_length( _actual ), _message );
	
	for ( var i = 0; i &lt; _size; i++ ) {
		var _item = _expected[ i ];
		if ( typeof( _item ) == "array" ) {
			assert_array_equals(  _item, _actual[ i ], _message );
		} else {
			assert( _item == _actual[ i ], _message );
		}
	}
}

#endregion

#region data_structues

/// @function _list
/// @desc returns ds_list
/// @arg [...]

function _list( ) {
	var _ds = ds_list_create();
	var _n = argument_count;
	
	for (var i = 0; i &lt; _n; i++ ) {
		_ds[| i ] = argument[ i ];
	}
	
	return _ds;
}

/// @function _stack
/// @desc returns ds_stack
/// @arg [...]

function _stack( ) {
	var _ds = ds_stack_create();
	var _n = argument_count;
	
	for (var i = 0; i &lt; _n; i++ ) {
		ds_stack_push( _ds, argument[ i ] );
	}
	
	return _ds;
}

/// @function _queue
/// @desc returns ds_queue
/// @arg [...]

function _queue( ) {
	var _ds = ds_queue_create();
	var _n = argument_count;
	
	for (var i = 0; i &lt; _n; i++ ) {
		ds_queue_enqueue( _ds, argument[ i ] );
	}
	
	return _ds;
}

/// @function _map
/// @desc returns ds_map
/// @arg {array} [...] key, value pairs

function _map( ) {
	var _ds = ds_map_create();
	var _n = argument_count;
	
	for (var i = 0; i &lt; _n; i++ ) {
		var _t = argument[ i ];
		ds_map_add( _ds, _t[ 0 ], _t[ 1 ] );
	}
	
	return _ds;
}

/// @function _priority
/// @desc returns ds_priority
/// @arg {array} [...] value, priority pairs

function _priority( ) {
	var _ds = ds_priority_create();
	var _n = argument_count;
	
	for (var i = 0; i &lt; _n; i++ ) {
		var _t = argument[ i ];
		ds_priority_add( _ds, _t[ 0 ], _t[ 1 ] );
	}
	
	return _ds;
}

/// @func Map()
/// @name Map
/// @class
///
/// @classdesc Map-like data structure
///
/// @return {Map} - Map struct

function Map() constructor {
	/// @member {Struct} data
	/// @memberof Map
	///
	/// @desc Key-value pairs
	data = { };
	
	/// @member {Number} size
	/// @memberof Map
	///
	/// @desc Amount of defined entries.
	size = 0;
	
	static __iter = function() {
		var _iter = __iter_dict( data, function() {
			var _result = cache;
			cache = undefined;
			++index;
			return _result;
		}, function( _key ) {
			return variable_struct_get( data, _key );
		}, function() {
			while ( ( index &lt; size ) &amp;&amp; is_undefined( cache ) ) {
				cache = keys[ index ];
				if ( is_undefined( get( cache ) ) ) {
					cache = undefined;
					++index;
				}
			}
			
			return index >= size;
		} );
	
		_iter.keys = variable_struct_get_names( data );
		_iter.index = 0;
		_iter.cache = undefined;
		_iter.size = array_length( _iter.keys );

		return _iter;
	}
	
	static add = function( _key, _value ) {
		if ( is_undefined( variable_struct_get( data, _key ) ) ) {
			if ( !is_undefined( _value ) ) {
				++size;	
			}
		} else if ( is_undefined( _value ) &amp;&amp; ( --size == 0 ) ) {
			clear();
			exit;
		}
				
		variable_struct_set( data, _key, _value );
	}
	
	/// @method clear
	/// @memberof Map
	///
	/// @desc Remove all items from Map
	
	static clear = function() {
		delete data;
		
		size = 0;
		
		data = { };
	};
	
	/// @method exists
	/// @memberof Map
	///
	/// @desc Return true if the specified key exists in Map
	///
	/// @arg {Any} key
	///
	/// @return {Bool}
	
	static exists = function( _key ) {
		return !is_undefined( variable_struct_get( data, _key ) );
	};
	
	/// @method get
	/// @memberof Map
	///
	/// @desc Returns value associated with the key. If no such key exists then the function will return undefined.
	///
	/// @arg {Any} key
	///
	/// @return {Any}
	
	static get = function( _key ) {
		return variable_struct_get( data, _key );
	}
	
	/// @method is_empty
	/// @memberof Map
	///
	/// @desc Return false if Map has any items, true if it does not.
	///
	/// @return {Bool}
	
	static is_empty = function() {
		return ( size == 0 );
	}
	
	/// @method set
	/// @memberof Map
	///
	/// @desc Writes new value associated with key.
	///
	/// @arg {Any} key If key exists, previous value would be overwritten.
	/// @arg {Any} value If undefined, key is removed.
	///
	/// @return {Bool}
	
	static set = add;
	
	/// @method remove
	/// @memberof Map
	///
	/// @desc Remove key from the Map
	///
	/// @arg {Any} key
	
	static remove = function( _key ) {
		if ( is_undefined( variable_struct_get( data, _key ) ) ) {
			exit;
		}
		
		variable_struct_set( data, _key, undefined );
		
		if ( --size == 0 ) {
			clear();
		}
	}
	
	static to_string = function() {
		var _result = "{ ";
		
		var _iter = __iter();
		var _comma = false;
		
		while( !_iter.is_done() ) {
			var a = _iter.next();
			_result += ( _comma ? ", " : "" ) + a[ 0 ] + " : " + string( a[ 1 ] );
			_comma = true;
		}
		
		delete _iter;
		
		return _result + " }";
	}
}

#endregion

#region misc

/// @func apply
///
/// @desc Executes function with arguments passed as array. Up to 16 arguments supported.
///
/// @arg {Method} function
/// @arg {Array} arguments
///
/// @return {Any} Result returned by function
///
/// @example
/// apply( min, [ 1, 2, 3 ] ) --> 1

function apply( func, a ) {
	var size = array_length( a );
	switch ( size ) {
			case 0: return func( );
			case 1: return func( a[0] );
			case 2: return func( a[0], a[1] );
			case 3: return func( a[0], a[1], a[2] );
			case 4: return func( a[0], a[1], a[2], a[3] );
			case 5: return func( a[0], a[1], a[2], a[3], a[4] );
			case 6: return func( a[0], a[1], a[2], a[3], a[4], a[5] );
			case 7: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6] );
			case 8: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7] );
			case 9: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8] );
			case 10: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9] );
			case 11: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10] );
			case 12: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11] );
			case 13: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12] );
			case 14: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13] );
			case 15: return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14] );
			default:
				return func( a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15] );
		}
}

/// @func to_string
///
/// @desc Returs string representation of object
///
/// @arg {Any} object
/// @arg [separator]
///
/// @return {String}

function to_string( _object ) {
	switch typeof( _object ) {
		case "struct":
			if ( variable_struct_exists( _object, "to_string" ) ) {
				var _separator = ( argument_count > 1 ) ? argument[ 1 ] : "";
				return _object.to_string( _separator );
			}
			return string( _object );
			
		default:
			return string( _object );
	}
}

/// @func log
/// @desc Concatenates all arguments and outputs to console using show_debug_message
/// @arg {Any} [...]

function log() {
	var _s = "";

	for ( var i = 0; i &lt; argument_count; i++ ) {
		_s += ( ( i > 0 ) ? " " : "" ) + to_string( argument[ i ] );
	}

	show_debug_message( _s );
}

#endregion

#region operators

/// @func _add
///
/// @desc Add values of two arguments
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a + b
///
/// @example
/// _add( 2, 2 ) --> 4
///_add( "foo", "bar" ) --> "foobar:

function _add( a, b ) {
	return a + b;
}

/// @func bit_length
///
/// @desc Returns number of bits that are needed to represent a.
///
/// @arg {Number} a
///
/// @return {Number}
///
/// @example
/// bit_length( -37 ) --> 6 // -37 = -0b100101

function bit_length( a ) {
	return floor( log2 ( abs( a ) ) ) + 1;	
}

/// @func factorial
///
/// @desc Return x factorial as an integer.
///
/// @arg {Number} x
///
/// @return {Number}

function factorial( a ) {
	if ( ( a &lt; 0 ) || ( a != floor( a ) ) ) {
		throw "factorial only supports positive integer values";
	}
	
	if ( a &lt; 21 ) {
		return SMALL_FACTORIALS[ a ];	
	}
	
	var num_of_set_bits = function( i ) {
		i = i - ( ( i >> 1 ) &amp; $55555555 );
		i = ( i &amp; $33333333 ) + ( ( i >> 2 ) &amp; $33333333 );
		return ( ( ( i + ( i >> 4 ) &amp; $F0F0F0F ) * $1010101 ) &amp; $ffffffff ) >> 24;
	}
	
	var _inner = 1;
	var _outer = 1;
	var n = bit_length( a );
	
	for ( var i = n; i >= 0; i-- ) {
		_inner *= range_prod( ( ( a >> ( i + 1 ) ) + 1 ) | 1, ( ( a >> i ) + 1 ) | 1, 2 );
		_outer *= _inner;
	}
	
	return 1.0 * _outer &lt;&lt; ( a - num_of_set_bits( a ) );
}

/// @func _div
///
/// @desc Divides first argment by the secone one
/// @see _floordiv
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a / b
///
/// @example
/// _div( 4, 2 ) --> 2

function _div( a, b ) {
	return a / b;
}

/// @func _floordiv
///
/// @desc Divides first argment by the secone one and returns integer part.
/// @see _div
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a div b
///
/// @example
/// _div( 5, 2 ) --> 2.50
///_floordiv( 5, 2 ) --> 2

function _floordiv( a, b ) {
	return a div b;
}

/// @func _identity
///
/// @desc Function that returns it's argument
///
/// @arg {Any} a
///
/// @return {Any} a
///
/// @example
/// _identity( 10 ) --> 10

function _identity( a ) {
	return a;
}

/// @func is_between
///
/// @desc Check if value is in range [ a, b ]
///
/// @arg {Number} value
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Bool}

function is_between( _value, a, b ) {
	return ( b > a ) ? ( ( _value >= a ) &amp;&amp; ( _value &lt;= b ) ) : ( ( _value &lt;= a ) &amp;&amp; ( _value >= b ) );
}

/// @func isqrt
///
/// @desc  Return the integer part of the square root of n.
///
/// @arg {Number} n
///
/// @return {Number}
///
/// @example
/// isqrt( 6 ) --> 2

function isqrt( n ) {
	n = floor( n );
	
	if ( n &lt; 0 ) {
		throw "sqrt() argument must be nonnegative";	
	}
	
	if ( n == 0 ) {
		return 0;	
	}
	
	var c = ( bit_length( n ) - 1 ) div 2;
	var a = 1;
	var d = 0
	
	for ( var s = bit_length( c ) - 1; s >= 0; s-- ) {
		var e = d;
		var d = c >> s;
		a = ( a &lt;&lt; ( d - e - 1 ) ) + ( n >> ( 2 * c - e - d + 1 ) ) div a;
	}

	return a - bool( a * a > n );
}

/// @func _max
///
/// @desc Returns largest of the input values
///
/// @arg {Number} _a
/// @arg {Number} _b
/// @arg {Number} [...]
///
/// @return {Number} Largest of the input values
///
/// @example
/// _max( 1, 2, 3 ) --> 3

_max = function( _a, _b ) {
	var _result = _a;
	var _n = argument_count;
	
	for( var i = 1; i &lt; _n; ++i ) {
		_result = max( _result, argument[ i ] );	
	}
	
	return _result;
}

/// @func _min
///
/// @desc Returns smallest of the input values
///
/// @arg {Number} _a
/// @arg {Number} _b
/// @arg {Number} [...]
///
/// @return {Number} Smallest of the input values
///
/// @example
/// _min( 1, 2, 3 ) --> 1

_min = function( _a, _b ) {
	var _result = _a;
	var _n = argument_count;
	
	for( var i = 1; i &lt; _n; ++i ) {
		_result = min( _result, argument[ i ] );	
	}
	
	return _result;
}

/// @func _mod
///
/// @desc Divides first argment by the secone one and returns modulus.
/// @see _rem
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} modulus of a divided by b
///
/// @example
/// _mod( 4, 2 ) --> 0

function _mod( a, b ) {
	return ( ( a % b ) + b ) % b;
}

/// @func _mul
///
/// @desc Multiplies argument values
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a * b
///
/// @example
/// _mul( 2, 2 ) --> 4

function _mul( a, b ) {
	return a * b;
}

/// @func _rem
///
/// @desc Divides first argment by the secone one and returns remainder.
/// @see _mod
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a % b
///
/// @example
/// _rem( 4, 2 ) --> 0

function _rem( a, b ) {
	return a % b;
}

/// @func _pow
///
/// @desc Substract second argument from the first one
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} power( a, b )
///
/// @example
/// _pow( 2, 2 ) --> 4

function _pow( a, b ) {
	return power( a, b );
}

/// @func _sub
///
/// @desc Substract second argument from the first one
///
/// @arg {Number} a
/// @arg {Number} b
///
/// @return {Number} a - b
///
/// @example
/// _sub( 4, 2 ) --> 2

function _sub( a, b ) {
	return a - b;
}

/// @func _truth
///
/// @desc Returns if argument is true
///
/// @arg {Any} a
///
/// @return {Bool} Boolean representation of object
///
/// @example
/// _truth( 1 ) --> true
///_truth( 0.2 ) --> false

function _truth( a ) {
	return bool( a );
}

#endregion</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Thu Jul 09 2020 13:23:10 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
